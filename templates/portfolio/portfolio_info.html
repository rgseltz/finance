{% extends 'base.html' %}
{% block title %}Portfolio Info{% endblock %}

{% block content %}
<section id="pf-nav">
    <ul id="pf-list" class="list-group list-group-horizontal">
        {% for p in user.portfolios %}
        <li class="list-group-item"><a href="/portfolios/{{p.id}}" class="btn btn-info">{{p.id}}  {{p.portfolio_name}}</a></li>
        {% endfor %}
    </ul>

    </section>
<h1>{{user.username}}'s Portfolios</h1>
<h2>{{portfolio.portfolio_name}}</h2><button class="btn btn-small" action="/portfolios/{{portfolio.id}}/edit">Change Name</button>
<form class="navbar-form" method="POST" action="/portfolios/{{portfolio.id}}/addstock">
    <input placeholder="Add Stock" id="search" name="add-stock">
    <button class="btn btn-default" >Add Stock</button>
  </form>
  
<table>
    {% if portfolio.stocks %}
    <thead>
        <th>Name</th>
        <th>Ticker</th>
        <th>Price</th>
    </thead>
    <tbody>
        {% for stock in portfolio.stocks %}
    <tr>
        <td><span><form method="POST" action="/portfolios/{{portfolio.id}}/transactions/{{stock.id}}/new">
            <button class="btn btn-default" >Add Transaction</button></form></span></td>
        <td><a href="/quote/{{stock.ticker}}/profile">{{stock.stock_name}}</a><form action="/portfolios/{{portfolio.id}}/stock/{{stock.id}}/delete" method="post"><button>Delete</button></form>
        <td>{{stock.ticker}}</td>
        <td>{{stock.price}}</td> 
        {% for transaction in portfolio.transactions %}
        {% if transaction.ticker == stock.ticker %}
        <td><span><a href="/portfolios/{{portfolio.id}}/transactions/{{transaction.id}}">
        <button class="btn btn-default" >View Transaction</button>
        </span></td>
        {% endif %}
        {% endfor %}
    </tr>
        {% endfor %}
    </tbody>
    
    {% endif %}
</table>
<form action="/portfolios/{{portfolio.id}}/delete" method="post">
    <button>Delete Portfolio</button>
</form>
<form action="/portfolios/{{portfolio.id}}/edit">
    <button>Edit Portfolio Name</button>
</form>
{% endblock %}